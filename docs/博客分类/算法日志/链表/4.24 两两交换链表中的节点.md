# [24. 两两交换链表中的节点](https://leetcode.cn/problems/swap-nodes-in-pairs/)

## 一、题目



给你一个链表，两两交换其中相邻的节点，并返回交换后链表的头节点。你必须在不修改节点内部的值的情况下完成本题（即，只能进行节点交换）。

 

**示例 1：**

![img](4.24 两两交换链表中的节点.assets/swap_ex1.jpg)

```
输入：head = [1,2,3,4]
输出：[2,1,4,3]
```

**示例 2：**

```
输入：head = []
输出：[]
```

**示例 3：**

```
输入：head = [1]
输出：[1]
```

 

**提示：**

- 链表中节点的数目在范围 `[0, 100]` 内
- `0 <= Node.val <= 100`

## 二、思路

### 2.1 递归版本

```java
// 递归版本
class Solution {
    /**
     * 交换链表中相邻的节点对。例如：
     * 给定 1->2->3->4，应返回 2->1->4->3。
     *
     * @param head 链表的头节点
     * @return 交换节点对后的新链表头节点
     */
    public ListNode swapPairs(ListNode head) {
        // base case: 如果链表为空或只有一个节点，无需交换，直接返回当前头节点
        if (head == null || head.next == null) {
            return head;
        }

        // 获取当前节点（head）的下一个节点，并将其赋值给变量 next
        ListNode next = head.next;

        // 递归调用：对当前节点（head）的下一个节点（next）的下一个节点进行递归调用，
        // 处理以 next.next 为头节点的子链表，返回处理后的子链表新头节点
        ListNode newNode = swapPairs(next.next);

        // 交换当前节点（head）与下一个节点（next）的位置
        // 连接交换后的节点：next -> head，head -> 新子链表头节点（newNode）
        next.next = head;
        head.next = newNode;

        // 返回交换后的当前节点对的新头节点（即原 next 节点）
        return next;
    }
}
```

这段代码是一个 Java 实现的递归解决方案，用于解决“链表中的两两交换节点”问题。`Solution` 类包含一个名为 `swapPairs` 的公共方法，该方法接收一个 `ListNode` 类型参数 `head`，表示链表的头节点。目标是将链表中的相邻节点两两交换位置。

代码注释已详细解释了各部分功能和逻辑：

1. 类定义与方法注释：描述了类的功能（递归版本的解决方案）以及 `swapPairs` 方法的作用、输入参数和返回值。

2. **Base Case**：检查链表是否为空（`head == null`）或只有一个元素（`head.next == null`）。如果是这两种情况，无需交换，直接返回当前头节点 `head`。

3. 获取当前节点（`head`）的下一个节点，并将其赋值给变量 `next`。

4. **递归调用**：对 `head` 的下一个节点（即 `next`）的下一个节点进行递归调用 `swapPairs(next.next)`。这一步相当于将问题规模缩小到处理以 `next.next` 为头节点的子链表。

5. **交换节点**：在递归返回后，已经得到了子链表处理后的结果（`newNode`），此时执行节点交换操作：

   - 将 `next` 的下一个节点指向 `head`（即 `next.next = head`），完成节点对的交换。
   - 将 `head` 的下一个节点指向处理后的子链表新头节点（即 `head.next = newNode`），确保链表连接正确。

6. **返回值**：返回交换后的当前节点对的新头节点（即原 `next` 节点），作为整个链表处理后的头节点。

### 2.2 迭代版本

```java
class Solution {
    /**
     * 交换链表中相邻的节点对。例如：
     * 给定 1->2->3->4，应返回 2->1->4->3。
     *
     * @param head 链表的头节点
     * @return 交换节点对后的新链表头节点
     */
    public ListNode swapPairs(ListNode head) {
        // 创建一个虚拟头结点，值为-1，用作辅助节点，便于后续操作
        ListNode dummyHead = new ListNode(-1);
        // 将虚拟头结点的next指针指向原链表头节点
        dummyHead.next = head;

        // 初始化当前节点（cur）指向虚拟头结点，用于遍历链表
        ListNode cur = dummyHead;
        // 创建临时节点temp，用于保存当前待交换节点对后面的节点
        ListNode temp;
        // 创建临时节点firstnode，用于保存待交换节点对的第一个节点
        ListNode firstnode;
        // 创建临时节点secondnode，用于保存待交换节点对的第二个节点
        ListNode secondnode;

        // 当前节点的下一个节点及其后继节点均非空时，继续循环
        while (cur.next != null && cur.next.next != null) {
            // 保存当前待交换节点对后面的节点
            temp = cur.next.next.next;
            // 保存待交换节点对的第一个节点
            firstnode = cur.next;
            // 保存待交换节点对的第二个节点
            secondnode = cur.next.next;

            // 步骤一：将当前节点的next指针指向第二个节点（即交换）
            cur.next = secondnode;
            // 步骤二：将第二个节点的next指针指向第一个节点（即交换）
            secondnode.next = firstnode;
            // 步骤三：将第一个节点的next指针指向原第三个节点（保持链表连续）
            firstnode.next = temp;

            // 移动当前节点（cur），使其指向刚交换过位置的第一个节点，准备下一轮交换
            cur = firstnode;
        }

        // 返回处理后的链表头节点，即虚拟头结点的下一个节点
        return dummyHead.next;
    }
}
```

这段代码实现了一个非递归版本的解决方案，用于解决“链表中的两两交换节点”问题。`Solution` 类包含一个名为 `swapPairs` 的公共方法，该方法接收一个 `ListNode` 类型参数 `head`，表示链表的头节点。目标是将链表中的相邻节点两两交换位置。

代码注释已详细解释了各部分功能和逻辑：

1. 类定义与方法注释：描述了类的功能以及 `swapPairs` 方法的作用、输入参数和返回值。

2. **创建虚拟头结点**：创建一个值为-1的虚拟头结点 `dummyHead`，用作辅助节点，便于后续操作。将虚拟头结点的 `next` 指针指向原链表头节点 `head`。

3. **初始化变量**：创建并初始化当前节点 `cur` 指向虚拟头结点，用于遍历链表；创建临时节点 `temp`、`firstnode` 和 `secondnode`，分别用于保存待交换节点对后面的节点、第一个节点和第二个节点。

4. **循环条件**：当当前节点的下一个节点及其后继节点均非空时，继续循环。

5. **节点交换**：
   - 保存当前待交换节点对后面的节点（`temp`）。
   - 保存待交换节点对的第一个节点（`firstnode`）和第二个节点（`secondnode`）。
   - 执行节点交换操作：
     - 步骤一：将当前节点的 `next` 指针指向第二个节点（即交换）。
     - 步骤二：将第二个节点的 `next` 指针指向第一个节点（即交换）。
     - 步骤三：将第一个节点的 `next` 指针指向原第三个节点（保持链表连续）。

6. **移动当前节点**：将当前节点（`cur`）指向刚交换过位置的第一个节点，准备下一轮交换。

7. **返回值**：返回处理后的链表头节点，即虚拟头结点的下一个节点。