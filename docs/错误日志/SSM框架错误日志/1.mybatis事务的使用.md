# mybatis事务的使用

## 一、问题

问题描述：我做了一个登录功能想要记录用户登录的日志信息，当管理员用户登录后可以查看所有用户的登录日志信息，当项目启动时，用管理员登录然后查看登录日志信息，可以查看本次的包含以前的所有登录日志信息。但是当退出登录切换其他用户登录时，并反复切换用户登录测试，最后再登录管理员用户登录查看日志信息时，只有最开始查看的4条日志信息，数据库表中确有7条用户登录日志信息。

<img src="1. mybatis事务的使用.assets/image-20240410184204641.png" alt="image-20240410184204641" style="zoom: 25%;" />

<img src="1. mybatis事务的使用.assets/image-20240410184347579.png" alt="image-20240410184347579" style="zoom: 25%;" />

## 二、原因

通过反复debug测试发现，在查询过程中，调用SqlSession采用了自动提交方式，改变代码使其为手动提交方式项目功能正常。

<img src="1. mybatis事务的使用.assets/image-20240410185510670.png" alt="image-20240410185510670" style="zoom:25%;" />

<img src="1. mybatis事务的使用.assets/image-20240410185533169.png" alt="image-20240410185533169" style="zoom:25%;" />